package utilisateur;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

public class Utilisateur {
	public static Connection connection = connexionDB();
	public static void main(String args[]) {
		connexionUtilisateur();
		menuAvecChoix();
	}
	
	public static void menuAvecChoix() {
		System.out.println("----------------------------------------------");
		System.out.println("|           Que voulez-vous faire ?          |");
		System.out.println("----------------------------------------------");
		System.out.println("|1. Introduire une nouvelle question.        |");
		System.out.println("|2. Visualiser les questions posées.         |");
		System.out.println("|3. Visualiser les questions repondues.      |");
		System.out.println("|4. Visualiser toutes les questions.         |");
		System.out.println("|5. Visualiser les questions d'un tag.       |");
		System.out.println("----------------------------------------------");
		Scanner scanner = new Scanner(System.in);
		int choix = 0;
		do {
			System.out.print("Veuillez rentrer votre choix : ");
			choix = scanner.nextInt();
		}while(!(choix > 0 && choix < 6));
		
		switch(choix) {
			case 1:
				introduireNouvelleQuestion();
				break;
			case 2:
				visualiserQuestionsPosees();
				break;
			case 3:
				visualiserQuestionsRepondues();
				break;
			case 4:
				toutesLesQuestions();
				break;
			case 5:
				visualiserQuestionsAvecTag(); 
				break;
		}
	}
	
	public static Connection connexionDB() {
		ConnexionDB aRenvoyer = new ConnexionDB();
		return aRenvoyer.getConnection();
	}
	
	public static boolean connexionUtilisateur() {
		Scanner scannerCo = new Scanner(System.in);
		System.out.println("Etes-vous deja inscrit ? (O/N)");
		String caract = scannerCo.nextLine();
		if("O".equals(caract)) {
			System.out.print("Veuillez entrer votre identifiant : ");
			String login = scannerCo.nextLine();
			System.out.print("Veuillez entrer votre mot de passe : ");
			String password = scannerCo.nextLine();
			try {
	            PreparedStatement ps = connection
	                    .prepareStatement("SELECT * FROM SOIPL.utilisateurs WHERE nom_utilisateur="+login+ " AND mot_de_passe=" + password);
	            ResultSet rs = ps.executeQuery();
	            
	            while (rs.next()) {
	                System.out.println(rs.getString(1));
	                
	            }
	            rs.close();
	            ps.close();

	        } catch (Exception e) {
	            e.printStackTrace();
	        }
			
			//TODO le false a changé et verification dans la db
			boolean valeurDeRetour = false; 
			if(valeurDeRetour == true) {
				
			}else {
				
			}
		}else{
			System.out.print("Veuillez entrer votre email : ");
			String email = scannerCo.nextLine();
			System.out.print("Veuillez entrer votre identifiant : ");
			String login = scannerCo.nextLine();
			System.out.print("Veuillez entrer votre mot de passe : ");
			String password = scannerCo.nextLine();
		}
		return true;
	}
	
	public static void introduireNouvelleQuestion() {
		System.out.println("Introduire une nouvelle question");
		menuAvecChoix();
	}
	
	public static void visualiserQuestionsPosees() {
		System.out.println("Affichage de toutes les Questions Posees");
		menuAvecChoix();
	}
	
	public static void toutesLesQuestions() {
		System.out.println("Affichage de toutes les questions");
		try {
            PreparedStatement ps = connection
                    .prepareStatement("SELECT * FROM SOIPL.questions");
            ResultSet rs = ps.executeQuery();
            while (rs.next()) {
                System.out.println(rs.getString(1) + ". " + rs.getString(7));
                
            }
            rs.close();
            ps.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
		
		menuAvecChoix();
	}
	
	public static void visualiserQuestionsRepondues() {
		System.out.println("Affichage de toutes les questions répondues");
		menuAvecChoix();
	}
	
	public static void visualiserQuestionsAvecTag() {
		System.out.println("Affichage de toutes les questions avec tag specifique");
		menuAvecChoix();
	}
}
